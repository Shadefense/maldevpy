import multiprocessing
import time
from GDI_effects.GDI import Effects
import os
#import webbrowser
#from ctypes import cast, POINTER
#from comtypes import CLSCTX_ALL
#from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume
#from playsound3 import playsound
#import tkinter as tk
#import random
#from pynput import mouse

#1. initialization
#root = tk.Tk()
#root.withdraw()
"""
def run_errors(count=15):
    Spawns scattered error windows with sounds across the screen.
    def spawn():
        # 1. Create window and hide it from the taskbar/remove title bar
        win = tk.Toplevel()
        win.title("System Error")
        win.attributes("-topmost", True) 
        
        # 2. Random Screen Positioning
        w, h = 320, 120
        x = random.randint(0, win.winfo_screenwidth() - w)
        y = random.randint(0, win.winfo_screenheight() - h)
        win.geometry(f"{w}x{h}+{x}+{y}")

        # 3. Add Content (Label and OK Button)
        tk.Label(win, text="âš  Critical Error\nProcess 0x8004210B has failed.", 
                 fg="black", font=("Arial", 10), pady=15).pack()
        tk.Button(win, text="OK", command=win.destroy, width=12).pack()

        # 4. Play the Windows Error Sound
        # Launch the storm in a loop
    for _ in range(count):
        # We use after() to stagger the appearance slightly for chaos
        root.after(_ * 150, spawn) 



def max_volume_windows():
    devices = AudioUtilities.GetSpeakers()
    interface = devices.Activate(IAudioEndpointVolume._iid_, CLSCTX_ALL, None)
    volume = cast(interface, POINTER(IAudioEndpointVolume))
    
    # 0.0 is the maximum volume in decibels for Pycaw
    volume.SetMasterVolumeLevel(0.0, None) 
    # Ensure it's not muted
    volume.SetMute(0, None)

#max_volume_windows()

def hear_errors():
    for _ in range(9999):
        playsound("error.wav", block=False)
"""
def run_rickroll():
    """Opens the youtube rick roll in new tabs"""
    i=0
    for i in range(0,9999):
        i += 1
        webbrowser.open_new_tab("https://www.youtube.com/watch?v=2qBlE2-WL60") #

# 1. Define the wrapper functions for various effects
def run_pan():
    """Pans the screen in random directions."""
    Effects.pan_screen(repeat=9999)

def run_tunnel():
    """Creates a zoom-tunnel effect."""
    Effects.tunnel_screen(repeat=9999)

def run_rotate():
    """Rotates the entire screen buffer."""
    Effects.rotate_screen(repeat=9999)

def run_wavy():
    """Creates a wavy distortion effect."""
    Effects.screen_wavy(repeat=9999)

def run_twisted():
    """Creates a twisted/spiral distortion."""
    Effects.twisted_screen(repeat=9999)

def run_glitch():
    """Creates digital glitch lines and shifts."""
    Effects.glitch_screen(repeat=9999)

def run_invert():
    """Inverts colors on screen."""
    Effects.invert_screen(repeat=9999)

def run_flip():
    """Flips screen upside down."""
    Effects.flip_screen_upside_down(repeat=9999)

def run_bw():
    """Converts screen to black and white."""
    Effects.bw_screen(repeat=9999)

def run_asterisk():
    """Creates asterisk pattern overlay."""
    Effects.asterisk_screen(repeat=9999)

def run_rainbow():
    """Rainbow blink effect."""
    Effects.rainbow_blink(repeat=9999)

def run_error():
    """Shows error screen effect."""
    Effects.error_screen(repeat=9999)

def run_warning():
    """Shows warning screen effect."""
    Effects.warning_screen(repeat=9999)

def run_question():
    """Shows question screen effect."""
    Effects.question_screen(repeat=9999)

def run_void():
    """Creates void/empty screen effect."""
    Effects.void_screen(repeat=9999)

def run_super_icon():
    """Creates super icon screen effect."""
    Effects.super_icon_screen(repeat=9999)

def run_repeat_block():
    """Repeating block rotation effect."""
    Effects.repeat_block_rotation(repeat=9999)

if __name__ == "__main__":
    run_pan()
    time.sleep(60)
    os._exit(0)
