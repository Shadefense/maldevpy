import subprocess
import time
import os
import psutil # You'll need: pip install psutil

# Names for the two processes
PROCESS_A = "shacrypt.pyw"
PROCESS_B = "shacrypt_background_work.pyw"

def is_running(script_name):
    """Check if a specific python script is currently running."""
    for proc in psutil.process_iter(['cmdline']):
        try:
            if script_name in str(proc.info['cmdline']):
                return True
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass
    return False

def keep_alive(target_script):
    """If the target isn't running, start it."""
    if not is_running(target_script):
        print(f"Restarting {target_script}...")
        subprocess.Popen(["python", target_script])

# Example loop for process_a.py to watch process_b.py
if __name__ == "__main__":
    current_script = os.path.basename(__file__)
    target = PROCESS_B if current_script == PROCESS_A else PROCESS_A
    
    while True:
        keep_alive(target)
        time.sleep(1) # Check every second
